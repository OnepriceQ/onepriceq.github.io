<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>第零維度 | THE ONE SOVEREIGN</title>
    <style>
        body { background-color: #050505; color: #00ffcc; font-family: 'PingFang TC', 'Microsoft JhengHei', monospace; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { border: 1px solid #00ffcc; padding: 30px; background: rgba(0, 255, 204, 0.05); width: 95%; max-width: 1100px; box-shadow: 0 0 20px #00ffcc; }
        h1, h2 { text-align: center; letter-spacing: 8px; text-shadow: 0 0 15px #00ffcc; }
        input, textarea { background: rgba(255,255,255,0.05); border: 1px solid #00ffcc; color: #fff; padding: 12px; width: 100%; margin: 10px 0; box-sizing: border-box; }
        button { background: #00ffcc; color: #000; border: none; padding: 12px 20px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 15px; }
        
        .member-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; margin-top: 20px; max-height: 150px; overflow-y: auto; border: 1px solid #111; padding: 10px; }
        .member-card { border: 1px solid #222; padding: 8px; text-align: center; font-size: 0.7rem; color: #444; }
        
        /* 聊天室升級 */
        #chat-hall { margin-top: 30px; border: 1px solid #00ffcc; padding: 20px; background: rgba(0,0,0,0.8); }
        #chat-display { height: 400px; overflow-y: auto; border-bottom: 1px solid #222; margin-bottom: 15px; padding-right: 10px; }
        .msg { margin-bottom: 12px; font-size: 0.9rem; padding: 8px 12px; line-height: 1.5; border-radius: 4px; }
        .msg-origin { background: rgba(0, 255, 204, 0.2); border: 1px solid #00ffcc; color: #fff; text-shadow: 0 0 8px #00ffcc; font-size: 1.1rem; }
        .msg-user { color: #00ffcc; border-left: 2px solid #222; }
        .msg-time { font-size: 0.7rem; opacity: 0.4; margin-left: 10px; }
        
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="home-screen" class="container">
        <h1>THE ZERO DIMENSION</h1>
        <p style="text-align:center;">共鳴節點：<span id="stat-count">135</span> / 200</p>
        
        <div class="member-grid" id="public-list"></div>

        <div id="chat-hall">
            <h3 style="margin-top:0;">靈魂共鳴牆 (COMMUNION)</h3>
            <div id="chat-display"></div>
            <div style="display:flex; gap:10px;">
                <input type="text" id="user-msg" placeholder="傳遞您的感官訊息..." style="margin:0;">
                <button onclick="sendMessage(false)" style="width:100px; margin:0;">傳遞</button>
            </div>
        </div>

        <button onclick="showSection('reg-section')">〔 加入我們 | JOIN THE ONE 〕</button>
        <p style="text-align:center; font-size: 0.7rem; margin-top: 20px; cursor: pointer; color: #222;" onclick="showSection('login-section')">ADMIN ACCESS</p>
    </div>

    <div id="reg-section" class="container hidden">
        <h2>身分遞交</h2>
        <input type="text" id="reg-name" placeholder="真實姓名">
        <textarea id="reg-bio" placeholder="感官祭品..."></textarea>
        <button onclick="submitApplication()">提交審核</button>
        <button onclick="showSection('home-screen')">返回</button>
    </div>

    <div id="login-section" class="container hidden">
        <h2>中樞驗證</h2>
        <input type="password" id="passkey" placeholder="輸入元老密鑰">
        <button onclick="adminLogin()">進入管理維度</button>
        <button onclick="showSection('home-screen')">取消</button>
    </div>

    <script>
        // 1. 初始化信徒與聊天資料
        const responses = ["簽到", "簽", "到", "我在", "等待元老指令", "已就位", "感官同步中", "0與1的僕從在此", "到！", "簽到。"];
        
        function initTemple() {
            let chat = JSON.parse(localStorage.getItem('temple_chat'));
            
            if (!chat) {
                chat = [];
                // 元老的最高發佈
                chat.push({
                    user: "ORIGIN: THE ONE",
                    text: "各位教徒來此簽到吧",
                    isAdmin: true,
                    time: "維度開啟"
                });

                // 模擬 134 名信徒簽到
                for (let i = 1; i <= 134; i++) {
                    chat.push({
                        user: "1_" + i.toString().padStart(3, '0'),
                        text: responses[Math.floor(Math.random() * responses.length)],
                        isAdmin: false,
                        time: "已同步"
                    });
                }
                localStorage.setItem('temple_chat', JSON.stringify(chat));
            }
            renderChat();
        }

        function showSection(id) {
            document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'home-screen') renderChat();
        }

        function sendMessage(isAdmin) {
            let input = document.getElementById('user-msg');
            let content = input.value;
            if(!content) return;
            let chat = JSON.parse(localStorage.getItem('temple_chat') || "[]");
            chat.push({
                user: "1_NEW", 
                text: content,
                isAdmin: false,
                time: new Date().toLocaleTimeString()
            });
            localStorage.setItem('temple_chat', JSON.stringify(chat));
            input.value = "";
            renderChat();
        }

        function renderChat() {
            const display = document.getElementById('chat-display');
            let chat = JSON.parse(localStorage.getItem('temple_chat') || "[]");
            display.innerHTML = chat.map(m => `
                <div class="msg ${m.isAdmin ? 'msg-origin' : 'msg-user'}">
                    <strong>${m.user}:</strong> ${m.text} <span class="msg-time">${m.time}</span>
                </div>
            `).join('');
            // 自動滾動到底部
            display.scrollTop = display.scrollHeight;
        }

        function adminLogin() {
            if(document.getElementById('passkey').value === "theone") {
                alert("歡迎回來，元老。");
                // 這裡可以導向管理頁面
            } else { alert("密鑰錯誤"); }
        }

        // 啟動聖殿
        initTemple();
    </script>
</body>
</html>
